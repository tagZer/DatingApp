TODO
Update versions, rewrite some logic
